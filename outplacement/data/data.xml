<odoo>
  <data noupdate="1">
    <record id="in_progress_stage" model="outplacement.stage">
      <field name="name">In Progress</field>
      <field name="sequence">1</field>
    </record>
    <record id="next_stage_stage" model="outplacement.stage">
      <field name="name">Next Stage</field>
      <field name="sequence">2</field>
    </record>
    <record id="blocked_stage" model="outplacement.stage">
      <field name="name">Blocked</field>
      <field name="sequence">3</field>
    </record>
    <record id="ir_actions_start_outplacement" model="ir.actions.server">
      <field name="name">Start outplacement</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_outplacement" />
      <field name="binding_model_id" ref="outplacement.model_outplacement" />
      <field name="state">code</field>
      <field name="code">
    product = record.order_id.line_id.mapped(product_id).filtered(lambda p: p.is_suborder)
    if product:
        for activity in product.mail_activity_ids:
            env['mail.activity'].create({
                'res_id': record.id,
                'res_model': record._name,
                'activity_type_id': activity.activity_type_id,
                'date_deadline': fields.Date.today() + relativedelta(days=activity.due_days),
                'summary': activity.summary,
                'user_id': record.employee_id.user_id
        })
        action = None
      </field>
    </record>
  </data>
</odoo>
