<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!-- Replaced by button. Leaving this code here for now -->
        <!-- <record id="ir_actions_server_send_gp_to_bar" model="ir.actions.server">
          <field name="name">Send GP to BAR</field>
          <field name="type">ir.actions.server</field>
          <field name="model_id" ref="model_outplacement" />
          <field name="binding_model_id" ref="outplacement.model_outplacement" />
          <field name="state">code</field>
          <field name="code">action = records.send_gp_to_bar()</field>
        </record> -->
        <record id="act_project_project_2_project_task_all" model="ir.actions.act_window">
            <field name="name">Tasks</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">kanban,tree,form,calendar,pivot,graph,activity</field>
            <field name="domain">[('outplacement_id','=',active_id)]</field>
            <field name="context">
                {
                'search_default_outplacement_id': [active_id],
                'default_outplacement_id': active_id,
                }
            </field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Click
                    <i>Create</i>
                    to start a new task.
                </p>
                <p>
                    To get things done, use activities and status on tasks.
                    <br/>
                    Chat in real time or by email to collaborate efficiently.
                </p>
            </field>
        </record>
        <record id="outplacement_form_view" model="ir.ui.view">
            <field name="name">Outplacement</field>
            <field name="model">outplacement</field>
            <field name="inherit_id" ref="outplacement.outplacement_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//header" position="inside">
                    <button name="send_gp_to_bar" string="Send GP to BAR" type="object"/>
                </xpath>
                <group name="service" position="inside">
                    <field name="jp_sent_date" required="False" readonly="1"/>
                </group>
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" type="action"
                            name="%(act_project_project_2_project_task_all)d" icon="fa-tasks">
                        <field string="Tasks" name="task_count" widget="statinfo"
                               options="{'label_field': 'label_tasks'}"/>
                    </button>
                </div>
            </field>
        </record>

        <record id="view_outplacement_kanban_for_jp_submit_time" model="ir.ui.view">
            <field name="name">outplacement.view.kanban.inherit.for.jp.submit.time</field>
            <field name="model">outplacement</field>
            <field name="inherit_id" ref="outplacement.outplacement_kanban_view"/>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="time_to_submit_jp"/>
                </field>
                <xpath expr="//div[hasclass('o_kanban_record_body')]" position="inside">
                     <t t-if="record.time_to_submit_jp.raw_value">
                        <br/><span style="color:red;font-size:12px">Time to submit joint planning</span>
                     </t>
                </xpath>
            </field>
        </record>
    </data>
</odoo>
